!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Visualizer=e():t.Visualizer=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e,r){"use strict";t.exports=r(1)},function(t,e,r){"use strict";
/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2),i="function"==typeof Symbol&&Symbol.for,s=i?Symbol.for("react.element"):60103,o=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,c=i?Symbol.for("react.strict_mode"):60108,h=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,l=i?Symbol.for("react.context"):60110,f=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,d=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,g="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function x(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||y}function S(){}function w(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||y}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},S.prototype=x.prototype;var O=w.prototype=new S;O.constructor=w,n(O,x.prototype),O.isPureReactComponent=!0;var E={current:null},P=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};function j(t,e,r){var n,i={},o=null,a=null;if(null!=e)for(n in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(o=""+e.key),e)P.call(e,n)&&!M.hasOwnProperty(n)&&(i[n]=e[n]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var h=Array(c),u=0;u<c;u++)h[u]=arguments[u+2];i.children=h}if(t&&t.defaultProps)for(n in c=t.defaultProps)void 0===i[n]&&(i[n]=c[n]);return{$$typeof:s,type:t,key:o,ref:a,props:i,_owner:E.current}}function C(t){return"object"==typeof t&&null!==t&&t.$$typeof===s}var z=/\/+/g,R=[];function T(t,e,r,n){if(R.length){var i=R.pop();return i.result=t,i.keyPrefix=e,i.func=r,i.context=n,i.count=0,i}return{result:t,keyPrefix:e,func:r,context:n,count:0}}function k(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>R.length&&R.push(t)}function _(t,e,r){return null==t?0:function t(e,r,n,i){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case s:case o:c=!0}}if(c)return n(i,e,""===r?"."+$(e,0):r),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var h=0;h<e.length;h++){var u=r+$(a=e[h],h);c+=t(a,u,n,i)}else if(null===e||"object"!=typeof e?u=null:u="function"==typeof(u=g&&e[g]||e["@@iterator"])?u:null,"function"==typeof u)for(e=u.call(e),h=0;!(a=e.next()).done;)c+=t(a=a.value,u=r+$(a,h++),n,i);else if("object"===a)throw n=""+e,Error(v(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return c}(t,"",e,r)}function $(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function I(t,e){t.func.call(t.context,e,t.count++)}function A(t,e,r){var n=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?B(t,n,r,(function(t){return t})):null!=t&&(C(t)&&(t=function(t,e){return{$$typeof:s,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(z,"$&/")+"/")+r)),n.push(t))}function B(t,e,r,n,i){var s="";null!=r&&(s=(""+r).replace(z,"$&/")+"/"),_(t,A,e=T(e,s,n,i)),k(e)}var N={current:null};function U(){var t=N.current;if(null===t)throw Error(v(321));return t}var H={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:n};e.Children={map:function(t,e,r){if(null==t)return t;var n=[];return B(t,n,null,e,r),n},forEach:function(t,e,r){if(null==t)return t;_(t,I,e=T(null,null,e,r)),k(e)},count:function(t){return _(t,(function(){return null}),null)},toArray:function(t){var e=[];return B(t,e,null,(function(t){return t})),e},only:function(t){if(!C(t))throw Error(v(143));return t}},e.Component=x,e.Fragment=a,e.Profiler=h,e.PureComponent=w,e.StrictMode=c,e.Suspense=p,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,e.cloneElement=function(t,e,r){if(null==t)throw Error(v(267,t));var i=n({},t.props),o=t.key,a=t.ref,c=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,c=E.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(u in e)P.call(e,u)&&!M.hasOwnProperty(u)&&(i[u]=void 0===e[u]&&void 0!==h?h[u]:e[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){h=Array(u);for(var l=0;l<u;l++)h[l]=arguments[l+2];i.children=h}return{$$typeof:s,type:t.type,key:o,ref:a,props:i,_owner:c}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:l,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:t},t.Consumer=t},e.createElement=j,e.createFactory=function(t){var e=j.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:f,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return U().useCallback(t,e)},e.useContext=function(t,e){return U().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return U().useEffect(t,e)},e.useImperativeHandle=function(t,e,r){return U().useImperativeHandle(t,e,r)},e.useLayoutEffect=function(t,e){return U().useLayoutEffect(t,e)},e.useMemo=function(t,e){return U().useMemo(t,e)},e.useReducer=function(t,e,r){return U().useReducer(t,e,r)},e.useRef=function(t){return U().useRef(t)},e.useState=function(t){return U().useState(t)},e.version="16.13.1"},function(t,e,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,c=o(t),h=1;h<arguments.length;h++){for(var u in r=Object(arguments[h]))i.call(r,u)&&(c[u]=r[u]);if(n){a=n(r);for(var l=0;l<a.length;l++)s.call(r,a[l])&&(c[a[l]]=r[a[l]])}}return c}},function(t,e,r){"use strict";r.r(e);var n=r(0),i=r.n(n);var s=class{constructor(t){this.canvas=t.canvas,this.itemInfo=t.itemInfo,Object.prototype.hasOwnProperty.call(t,"active")?this.active=t.active:this.active=!0,Object.prototype.hasOwnProperty.call(t,"activator")?this.activator=t.activator:this.activator=()=>this.toggleActivate(),this.events=this.getEvents(),this.adjustSize(),this.init(),this.bindEvents(),"function"==typeof this.onWindowResize&&window.addEventListener("resize",this.onWindowResize.bind(this))}getEvents(){}init(){}draw(){}getConfig(){}setConfig(t){}renderToolbar(){}canvasToPoint(t){return t}pointToCanvas(t){return t}validatePoints(t){return t}emitUpdateEvent(){const t=new CustomEvent("visualizer-update");document.querySelectorAll("canvas").forEach(e=>e.dispatchEvent(t))}createPoint(t,e){const r=new DOMPoint;return r.x=t,r.y=e,r}adjustSize(){this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight}activate(){this.active=!0}deactivate(){this.active=!1}toggleActivate(){this.active=!this.active}getMouseEventPosition(t){const e=t.offsetX||t.pageX-this.canvas.offsetLeft,r=t.offsetY||t.pageY-this.canvas.offsetTop;return this.pixelToCoords(this.createPoint(e,r))}pixelToCoords(t){return this.createPoint(t.x/this.canvas.width,t.y/this.canvas.height)}coordsToPixel(t){return this.createPoint(t.x*this.canvas.width,t.y*this.canvas.height)}bindEvents(){Object.keys(this.events).forEach(t=>{let e=this.events[t];Array.isArray(e)||(e=[e]),e.forEach(e=>{this.canvas.addEventListener(t,e,!1)})})}unmount(){Object.keys(this.events).forEach(t=>{let e=this.events[t];Array.isArray(e)||(e=[e]),e.forEach(e=>{this.canvas.removeEventListener(t,e)})})}};const o="btn btn-primary m-1",a="btn btn-light m-1",c="moving",h="zooming";var u=class extends i.a.Component{constructor(t){super(t),this.state={active:t.activate,state:t.state}}render(){return i.a.createElement("div",{className:"col p-2"},this.renderMoveButton(),this.renderZoomRectButton(),this.renderHomeButton(),this.renderZoomPlusButton(),this.renderZoomMinusButton(),this.renderBackButton())}renderZoomRectButton(){let t=a;return this.props.active&&this.state.state==h&&(t=o),i.a.createElement("button",{type:"button",className:t,onClick:()=>this.handleZoomRect()},i.a.createElement("i",{className:"fas fa-expand"}))}renderMoveButton(){let t=a;return this.props.active&&this.state.state==c&&(t=o),i.a.createElement("button",{type:"button",className:t,onClick:()=>this.handleMove()},i.a.createElement("i",{className:"fas fa-arrows-alt"}))}renderHomeButton(){return i.a.createElement("button",{type:"button",className:a,onClick:()=>this.props.home()},i.a.createElement("i",{className:"fas fa-home"}))}renderZoomPlusButton(){return i.a.createElement("button",{type:"button",className:a,onClick:()=>this.props.zoom(2)},i.a.createElement("i",{className:"fas fa-search-plus"}))}renderZoomMinusButton(){return i.a.createElement("button",{type:"button",className:a,onClick:()=>this.props.zoom(-2)},i.a.createElement("i",{className:"fas fa-search-minus"}))}renderBackButton(){return i.a.createElement("button",{type:"button",className:a,onClick:()=>this.props.restoreState()},i.a.createElement("i",{className:"fas fa-undo"}))}handleMove(){this.props.activator(),this.props.setState(c),this.setState({active:!0,state:c})}handleZoomRect(){this.props.activator(),this.props.setState(h),this.setState({active:!0,state:h})}};const l="Visualizador de imagenes SELIA",f="1.0",p="Visualizador web que usa el contexto 2d de un canvas HTML5 para presentar imagenes png/jpg",d={definitions:{},$schema:"http://json-schema.org/draft-07/schema#",$id:"http://example.com/root.json",type:"object",title:"The Root Schema",required:["transformMatrix"],properties:{transformMatrix:{$id:"#/properties/transformMatrix",type:"object",title:"The Transformatrix Schema",required:["a","b","c","d","e","f"],properties:{a:{$id:"#/properties/transformMatrix/properties/a",type:"number",title:"The A Schema",default:0,examples:[1]},b:{$id:"#/properties/transformMatrix/properties/b",type:"number",title:"The B Schema",default:0,examples:[0]},c:{$id:"#/properties/transformMatrix/properties/c",type:"number",title:"The C Schema",default:0,examples:[0]},d:{$id:"#/properties/transformMatrix/properties/d",type:"number",title:"The D Schema",default:0,examples:[1]},e:{$id:"#/properties/transformMatrix/properties/e",type:"number",title:"The E Schema",default:0,examples:[0]},f:{$id:"#/properties/transformMatrix/properties/f",type:"number",title:"The F Schema",default:0,examples:[0]}}}}};function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const g=50,v=.5,y=.05,b=20,x="moving",S="zooming";e.default=class extends s{constructor(...t){super(...t),m(this,"name",l),m(this,"version",f),m(this,"description",p),m(this,"configurationSchema",d)}init(){this.canvas.style.cssText="-moz-box-shadow: inset 0 0 7px #404040;-webkit-box-shadow: inset 0 0 7px #404040;box-shadow:         inset 0 0 7px #404040;background-color: gray",this.ctx=this.canvas.getContext("2d"),this.image=new Image,this.image.src=this.getItemUrl(),this.stateHistory=[],this.toolbar=i.a.createRef(),this.last=this.createPoint(.5,.5),this.ratio=1,this.imgSize=null,this.state=x,this.config={scale:1,xOffset:0,yOffset:0,rotation:0},this.dragging={point:null,active:!1},this.zooming={start:null,end:null,active:!1},this.image.onload=()=>{this.imgSize=this.getImgSize(),this.ratio=this.getRatio(),this.draw()}}saveState(){this.stateHistory.push({...this.config}),this.stateHistory.length>b&&this.stateHistory.shift()}restoreState(){this.stateHistory.length>0?this.setConfig(this.stateHistory.pop()):this.resetConfig(),this.draw(),this.emitUpdateEvent()}discardState(){this.stateHistory.length>0&&this.stateHistory.pop()}draw(){this.clear(),this.setTransformFromState(),this.drawImage(),this.state===S&&this.zooming.active&&this.drawZoomRect()}drawImage(){const{widthRel:t,heightRel:e}=this.imgSize;this.ctx.drawImage(this.image,-t/2,-e/2,t,e)}drawZoomRect(){const t=this.transformCanvasToPoint(this.zooming.start),e=this.transformCanvasToPoint(this.zooming.end);this.ctx.strokeStyle="red",this.ctx.lineWidth=.001,this.ctx.strokeRect(t.x,t.y,e.x-t.x,e.y-t.y)}onWindowResize(){this.adjustSize(),this.ratio=this.getRatio(),this.draw(),this.emitUpdateEvent()}setTransformFromState(){const{width:t,height:e}=this.canvas,{scale:r,xOffset:n,yOffset:i,rotation:s}=this.config,o=t/2+n*t,a=e/2+i*e,c=this.ratio*r,h=s*Math.PI/180;this.ctx.setTransform(Math.cos(h)*c,Math.sin(h)*c,-Math.sin(h)*c,Math.cos(h)*c,o,a)}setState(t){this.state=t}getEvents(){return{mousedown:this.onMouseDown.bind(this),mousemove:this.onMouseMove.bind(this),mouseup:this.onMouseUp.bind(this),mouseout:this.onMouseOut.bind(this),DOMMouseScroll:this.onMouseScroll.bind(this),mousewheel:this.onMouseScroll.bind(this)}}onMouseOut(){this.state===x&&(this.dragging.point=null)}onMouseDown(t){if(this.last=this.getMouseEventPosition(t),this.canvasToPoint(this.last),this.state===x)return this.dragging.point=this.last,this.dragging.active=!1,void this.saveState();this.state===S&&(this.zooming.start=this.last)}onMouseMove(t){if(this.last=this.getMouseEventPosition(t),this.state===x&&this.dragging.point)return this.translate(this.last.x-this.dragging.point.x,this.last.y-this.dragging.point.y),this.dragging.active=!0,this.dragging.point=this.last,this.draw(),void this.emitUpdateEvent();this.state===S&&this.zooming.start&&(this.zooming.end=this.last,this.zooming.active=!0,this.draw())}onMouseUp(t){if(this.state===x)return this.dragging.point=null,void(this.dragging.active||(this.discardState(),this.zoom(t.shiftKey?-1:1,this.last)));this.state===S&&(this.saveState(),this.zoomOnRect(),this.zooming={start:null,end:null,active:!1},this.draw(),this.emitUpdateEvent())}onMouseScroll(t){let e=0;t.wheelDelta?e=t.wheelDelta/80:t.detail&&(e=-t.detail),e&&(this.saveState(),this.zoom(e,this.last)),t.preventDefault()}getImgSize(){const{height:t,width:e}=this.image,r=Math.max(t,e);return{height:t,width:e,factor:r,heightRel:t/r,widthRel:e/r}}getRatio(){const t=this.canvas.width,e=this.canvas.height,{width:r,height:n,factor:i}=this.imgSize,s=e/n,o=t/r;return s<o?s*i:o*i}clear(){this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore()}resetConfig(){this.config={scale:1,xOffset:0,yOffset:0,rotation:0}}centerImage(){this.resetConfig(),this.draw(),this.emitUpdateEvent()}renderToolbar(){return i.a.createElement(u,{active:this.active,activator:this.activator,state:this.state,setState:t=>this.setState(t),home:()=>this.centerImage(),restoreState:()=>this.restoreState(),zoom:t=>this.zoom(t,this.getCenterPoint()),ref:t=>{this.toolbar=t}})}getCenterPoint(){return this.createPoint(.5,.5)}getItemUrl(){return this.itemInfo.url}setScale(t){const e=this.config.scale,r=Math.min(Math.max(t,v),g),n=r/e;this.config.scale=r,this.config.xOffset*=n,this.config.yOffset*=n}setXOffset(t){this.config.xOffset=t}setYOffset(t){this.config.yOffset=t}setRotation(t){this.config.rotation=t%360}zoom(t,e){const{scale:r,xOffset:n,yOffset:i}=this.config,s=y*t,o=-(e.x-.5-n)*(s/r),a=-(e.y-.5-i)*(s/r);s+r>g||s+r<v||(this.config.scale=s+r,this.translate(o,a),this.draw(),this.emitUpdateEvent())}zoomOnRect(){const{start:t,end:e}=this.zooming,{scale:r}=this.config,n=this.createPoint((t.x+e.x)/2,(t.y+e.y)/2),i=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y),o=this.canvas.width,a=r/(this.canvas.height/s<o/i?s:i);this.centerOnPoint(n),this.setScale(a),this.setState(x),this.toolbar.setState&&this.toolbar.setState({state:x})}centerOnPoint(t){const{width:e,height:r}=this.imgSize,n=this.pointToCanvas(this.createPoint(e/2,r/2)),i=n.x-t.x,s=n.y-t.y;this.setXOffset(i),this.setYOffset(s)}translate(t,e){const{xOffset:r,yOffset:n}=this.config;this.setXOffset(r+t),this.setYOffset(n+e)}transformCanvasToPoint(t){const e=this.ctx.getTransform();return this.coordsToPixel(t).matrixTransform(e.invertSelf())}rotate(t){this.setRotation(this.config.rotation+t)}canvasToPoint(t){const{width:e,height:r,factor:n}=this.imgSize,i=this.transformCanvasToPoint(t);return i.x+=e/(2*n),i.y+=r/(2*n),i.x*=n,i.y*=n,i}pointToCanvas(t){const{widthRel:e,heightRel:r,factor:n}=this.imgSize,i=this.ctx.getTransform(),s=this.createPoint(t.x/n-e/2,t.y/n-r/2).matrixTransform(i);return this.pixelToCoords(s)}validatePoints(t){const e=Math.min(Math.max(t.x,0),this.image.width),r=Math.min(Math.max(t.y,0),this.image.height);return this.createPoint(e,r)}getConfig(){return this.config}setConfig(t){this.config=t}}}])}));